<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒ©ãƒ³ã‚­ãƒ³ã‚°</title>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
</head>
<body>
  <h1>ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¹ã‚³ã‚¢ã‚’ç™»éŒ²</h1>
  <input type="text" id="name" placeholder="åå‰ã‚’å…¥åŠ›" />
  <input type="number" id="wpm" placeholder="WPMã‚’å…¥åŠ›" />
  <button onclick="submitScore()">ã‚¹ã‚³ã‚¢é€ä¿¡</button>

  <h2>ğŸ† ãƒ©ãƒ³ã‚­ãƒ³ã‚°TOP10</h2>
  <ul id="ranking"></ul>

  <script>
    // ã“ã“ã«ã‚ãªãŸã® Firebase è¨­å®šã‚’è²¼ã‚‹ï¼ˆå¾Œã§OKï¼‰
    const firebaseConfig = {
      apiKey: "AIzaSyAqDSPE_HkPbi-J-SqPL4Ys-wR4RaA8wKA",
      authDomain: "otonano-typing-game.firebaseapp.com",
      projectId: "otonano-typing-game",
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function submitScore() {
      const name = document.getElementById("name").value;
      const wpm = parseInt(document.getElementById("wpm").value);

      if (!name || isNaN(wpm)) {
        alert("åå‰ã¨WPMã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„");
        return;
      }

      db.collection("scores").add({
        name: name,
        wpm: wpm,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      }).then(() => {
        alert("ä¿å­˜ã—ã¾ã—ãŸï¼");
        loadRanking();
      });
    }

    function loadRanking() {
      const list = document.getElementById("ranking");
      list.innerHTML = "";

      db.collection("scores")
        .orderBy("wpm", "desc")
        .limit(10)
        .get()
        .then(snapshot => {
          snapshot.forEach(doc => {
            const data = doc.data();
            const li = document.createElement("li");
            li.textContent = `${data.name} - ${data.wpm} WPM`;
            list.appendChild(li);
          });
        });
    }

    loadRanking();
  </script>
</body>
</html>
